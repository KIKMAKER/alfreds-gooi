<div class="driver-wrapper">
  <h1>Drop-Off Sites for <%= @drivers_day.date.strftime("%A, %B %e") %></h1>
  <%= link_to "← Back to Today's List", today_subscriptions_path, class: "link-title my-3" %>

  <% if @drop_off_events.any? %>
    <div class="collection-header">
      <div class="name"><p>Site</p></div>
      <div class="bag"><p>Weight</p></div>
      <div class="address"><p>Location</p></div>
      <div class="status"><p>Status</p></div>
    </div>

    <div class="collections">
      <ul>
        <% @drop_off_events.each do |event| %>
          <li class="collection">
            <div class="name">
              <p><%= event.drop_off_site.name %></p>
              <% if event.is_done %>
                <i class="fa-solid fa-check"></i>
              <% end %>
            </div>
            <div class="bag">
              <% if event.buckets.count > 0 %>
                <%= link_to "#{number_with_precision(event.total_weight_from_buckets, precision: 1)} kg",
                    drivers_day_drop_off_event_path(@drivers_day, event), class: "small-yellow-btn" %>
              <% else %>
                <%= link_to "Weigh", drivers_day_drop_off_event_path(@drivers_day, event), class: "small-yellow-btn" %>
              <% end %>
            </div>
            <div class="address">
              <%= link_to event.drop_off_site.suburb.truncate(20),
                  "https://maps.google.com/?q=#{event.drop_off_site.street_address}, #{event.drop_off_site.suburb}",
                  target: :_blank %>
            </div>
            <div class="status">
              <p><%= event.buckets.count %> buckets</p>
            </div>
          </li>
        <% end %>
      </ul>
    </div>
  <% else %>
    <div class="outline my-5">
      <p>No drop-off sites scheduled for today.</p>
    </div>
  <% end %>
</div>
