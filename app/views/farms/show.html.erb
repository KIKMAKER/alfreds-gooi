<div class="blog-container">
  <section class="farm-page-header">
    <div class="inner-header-container">
      <h1 class="blog-header-header"><%= @farm.name %></h1>
      <h4 class="text-white blog-header-subheader"><%= @farm.suburb %></h4>
      <p class="blog-paragraph-content"><em>
          One of our valued composting partners, helping turn Cape Town's food waste into healthy soil.
        </em></p>
      <p><%= @farm.story %></p>
    </div>
    <div class="wave-container">
      <svg
        class="waves"
        viewBox="0 24 150 28"
        preserveAspectRatio="none"
        shape-rendering="auto"
      >
        <defs>
          <path
            id="gentle-wave"
            d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18 58-18 88-18 58 18 88 18v44h-352z"
          ></path>
        </defs>
        <g class="parallax">
          <use
            href="#gentle-wave"
            x="0"
            y="0"
            fill="rgba(255,255,255)"
          ></use>
        </g>
      </svg>
    </div>
  </section>

  <!-- Image and Impact Stats -->
  <section class="blog-text-img-flex">
    <div class="flex-wrapper">
      <% if @farm.photo.attached? %>
        <div class="images-container">
          <div class="img-1">
            <%= image_tag @farm.photo, class: 'mission-image', alt: @farm.name %>
          </div>
        </div>
      <% end %>

      <div class="text-container">
        <h1>Our Impact Together<span class="yellow-txt">.</span></h1>
        <p class="mb-3">
          Since partnering with <%= @farm.name %>, we've made a real difference in diverting organic waste from landfills.
        </p>
        <div class="mt-4">
          <h3 class="yellow-txt"><%= number_with_precision(@farm.total_weight_kg || 0, precision: 1) %> kg</h3>
          <p>Total organic waste collected</p>

          <h3 class="yellow-txt mt-4"><%= @farm.total_dropoffs_count || 0 %></h3>
          <p>Drop-offs completed</p>

          <h3 class="yellow-txt mt-4">Every <%= @farm.collection_day %></h3>
          <p>Collection day</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Neighborhoods Served -->
  <section class="blog-text-section">
    <h1>Neighborhoods Served<span class="yellow-txt">.</span></h1>
    <p class="blog-paragraph-content">
      Every <%= @farm.collection_day %>, Alfred collects organic waste from these neighborhoods and delivers it to <%= @farm.name %>:
    </p>
    <div class="row mt-4">
      <% @farm.served_suburbs.each_slice((@farm.served_suburbs.size / 3.0).ceil) do |suburb_group| %>
        <div class="col-md-4">
          <ul class="list-unstyled">
            <% suburb_group.each do |suburb| %>
              <li class="mb-2 text-start">â€¢ <%= suburb %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>
  </section>

  <!--Call to sign up-->
  <div class="yellow-block">
    <h3>Want to add your kitchen scraps to the next compost pile?</h3>
    <div class="mt-5 mb-3">
      <%= link_to 'Sign Up', root_path(anchor: "pricing"), class: 'btn-gooi' %>
    </div>
  </div>

  <!-- Recent Drop-offs -->
  <% if @recent_events.any? %>
    <section class="blog-text-section">
      <h1>Recent Drop-offs<span class="yellow-txt">.</span></h1>
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Weight (kg)</th>
            </tr>
          </thead>
          <tbody>
            <% @recent_events.each do |event| %>
              <tr>
                <td><%= event.date.strftime('%B %e, %Y') %></td>
                <td><%= number_with_precision(event.weight_kg || 0, precision: 1) %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </section>
  <% end %>

  <!-- Social Links and Website -->
  <!-- Location and Contact -->
  <section class="blog-text-section mt-5">
    <h1>Connect with <%= @farm.name %><span class="yellow-txt">.</span></h1>
    <h3>Location</span></h3>
    <div class="d-flex">
      <p class="blog-paragraph-content w-75">
        <%= @farm.name %> can be found in <%= @farm.suburb %>. Feel free to pop in and connect with the soil, the farmers and the produce.
      </p>

      <% if @farm.latitude.present? && @farm.longitude.present? %>
        <div class="mt-4 w-25">
          <%= link_to "View on Google Maps",
              "https://maps.google.com/?q=#{@farm.latitude},#{@farm.longitude}",
              target: "_blank",
              class: "btn-gooi-green" %>
        </div>
      <% end %>
    </div>
  </section>

  <% if @farm.website.present? || @farm.instagram_handle.present? || @farm.facebook_url.present? %>
    <section class="blog-text-section">
      <div class="d-flex gap-4 mt-4">
        <% if @farm.website.present? %>
          <%= link_to @farm.website, target: "_blank", class: "text-decoration-none" do %>
            <div class="d-flex align-items-center">
              <i class="fa-solid fa-globe fa-2x me-2" style="color: #1f4632;"></i>
              <span style="color: #1f4632; font-size: 1.1rem;">Visit Website</span>
            </div>
          <% end %>
        <% end %>

        <% if @farm.instagram_handle.present? %>
          <%= link_to "https://instagram.com/#{@farm.instagram_handle}", target: "_blank", class: "text-decoration-none" do %>
            <div class="d-flex align-items-center">
              <i class="fa-brands fa-instagram fa-2x me-2" style="color: #1f4632;"></i>
              <span style="color: #1f4632; font-size: 1.1rem;">@<%= @farm.instagram_handle %></span>
            </div>
          <% end %>
        <% end %>

        <% if @farm.facebook_url.present? %>
          <%= link_to @farm.facebook_url, target: "_blank", class: "text-decoration-none" do %>
            <div class="d-flex align-items-center">
              <i class="fa-brands fa-facebook fa-2x me-2" style="color: #1f4632;"></i>
              <span style="color: #1f4632; font-size: 1.1rem;">Follow on Facebook</span>
            </div>
          <% end %>
        <% end %>
      </div>
    </section>
  <% end %>
</div>
